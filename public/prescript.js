(function(){var a=window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark",i=localStorage.getItem("theme")??a;document.documentElement.setAttribute("saved-theme",i);var l=t=>{let m=new CustomEvent("themechange",{detail:{theme:t}});document.dispatchEvent(m)};document.addEventListener("nav",()=>{let t=()=>{let d=document.documentElement.getAttribute("saved-theme")==="dark"?"light":"dark";document.documentElement.setAttribute("saved-theme",d),localStorage.setItem("theme",d),l(d)},m=d=>{let n=d.matches?"dark":"light";document.documentElement.setAttribute("saved-theme",n),localStorage.setItem("theme",n),l(n)};for(let d of document.getElementsByClassName("darkmode"))d.addEventListener("click",t),window.addCleanup(()=>d.removeEventListener("click",t));let c=window.matchMedia("(prefers-color-scheme: dark)");c.addEventListener("change",m),window.addCleanup(()=>c.removeEventListener("change",m))})})(),(function(){var a=!1,i=l=>{let t=new CustomEvent("readermodechange",{detail:{mode:l}});document.dispatchEvent(t)};document.addEventListener("nav",()=>{let l=()=>{a=!a;let t=a?"on":"off";document.documentElement.setAttribute("reader-mode",t),i(t)};for(let t of document.getElementsByClassName("readermode"))t.addEventListener("click",l),window.addCleanup(()=>t.removeEventListener("click",l));document.documentElement.setAttribute("reader-mode",a?"on":"off")})})(),(function(){var a="quartz-font-size",i="medium",l={small:14,medium:16,large:18};function t(){let n=localStorage.getItem(a);return n==="small"||n==="medium"||n==="large"?n:i}function m(n){let e=l[n];localStorage.setItem(a,n),document.documentElement.style.setProperty("--article-font-size",`${e}px`),document.documentElement.setAttribute("font-size",n);let o=document.querySelector("article");o&&(o.style.fontSize=`${e}px`)}function c(){let n=t(),e=["small","medium","large"],o=(e.indexOf(n)+1)%e.length,r=e[o];m(r)}function d(){let n=t();m(n),document.querySelectorAll(".font-size-toggle").forEach(e=>{let o=()=>c();e.addEventListener("click",o),window.addCleanup&&window.addCleanup(()=>e.removeEventListener("click",o))})}document.addEventListener("nav",d),d()})(),(function(){var a="font-family",i="default",l={default:"",songti:"STSong, SimSun, \u5B8B\u4F53, Songti SC, serif",kaiti:"KaiTi, \u6977\u4F53, KaiTi_GB2312, STKaiti, serif"};function t(){let e=localStorage.getItem(a);return e==="default"||e==="songti"||e==="kaiti"?e:i}function m(e){let o=l[e];o?document.documentElement.style.setProperty("--custom-body-font",o):document.documentElement.style.removeProperty("--custom-body-font"),document.documentElement.setAttribute("font-family",e),localStorage.setItem(a,e)}function c(){let e=document.documentElement.getAttribute("font-family")||i,o=["default","songti","kaiti"],r=(o.indexOf(e)+1)%o.length,u=o[r];m(u)}function d(){let e=t();m(e),document.querySelectorAll(".font-family-toggle").forEach(o=>{let r=()=>c();o.addEventListener("click",r),window.addCleanup&&window.addCleanup(()=>o.removeEventListener("click",r))})}var n=t();m(n),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",d):setTimeout(d,0),document.addEventListener("nav",()=>{setTimeout(d,0)})})();
